# Vulnerability Scans with OpenVAS

## Objective
[Brief Objective - Remove this afterwards]

Use and open-source tools that are available on the online to check vulnerabilities.

Will perform the following tasks:

-Conduct a vulnerability check using OpenVAS

## Lab Topology

<img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref0.png" alt="Alt text for image" width="375" height="276">

### Skills Learned
[Bullet Points - Remove this afterwards]

- Advanced understanding of SIEM concepts and practical application.
- Proficiency in analyzing and interpreting network logs.
- Ability to generate and recognize attack signatures and patterns.
- Enhanced knowledge of network protocols and security vulnerabilities.
- Development of critical thinking and problem-solving skills in cybersecurity.

### Tools Used
[Bullet Points - Remove this afterwards]

- Security Information and Event Management (SIEM) system for log ingestion and analysis.
- Network analysis tools (such as Wireshark) for capturing and examining network traffic.
- Telemetry generation tools to create realistic network traffic and attack scenarios.

## Conduct a Vulnerability Check Using OpenVAS

## 1.1 Start and Set the Services
<ol>
<li>On the Kali machine to access the graphical login screen</li>
<li>Log in kali machine with username and password</li>
<li>Open a Terminal window by clicking on the Terminal icon, located in the left menu pane</li>
<br>

<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref1.png" alt="Alt text for image" width="255" height="50">
<br>

<li>Enter command below to verify docker images metasploitable 2 and OpenVAS needed exists</li>
<br>

<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/Screenshot%202024-03-03%20042139.png" alt="Alt text for image" width="700" height="215">
<br>

<li>Next, we can start and setup metasploitable.<br> In the Terminal, type the following 
command to start the metasploit2.<br>This will redirect all incoming traffic to the kali machine.<br> 
Once executed, there will be a long string of numbers and letters, this is the container-id.</li>
<br>

<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref3.png" alt="Alt text for image" width="600" height="85">
<br>

<li>Now we can use the container-id to check the mapped ports between the kali machine and the 
container.<br>Type the command below to check all mapped ports.<br>Note: we only used the first 4 
characters/numbers from the container-id a0da.<br>All of the mapped ports are within the range of 49153-49172.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs_ovas-ref4.png" alt="Alt text for image" width="300" height="600">
<br>
<li>Now metasploitable2 running, click the browser icon to start the browser.</li>
<li>In the browser window address bar, type the address of http://localhost:49168. Press Enter and metasploitable2 will open.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref5.png" alt="Alt text for image" width="500" height="100">
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref6.png" alt="Alt text for image" width="534" height="341">
<br>
<li>On the page we just pulled up, we will check the database status of the DVWA machine.<br> First, click on the DVWA link. Wait for the following screen to shows up, type <strong>admin</strong> as the username and password as the password.<br>Then, click the Login button to log in. When prompted to save the password, click Never.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref7.png" alt="Alt text for image" width="376" height="316">
<li>If you pull up the following welcome screen, it means the service is up and running.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref8.png" alt="Alt text for image" width="449" height="285">
</ol>

## 1.2 Start the OpenVAS Scanner
<ol>
<li>Switch back to the terminal window.</li>
<li>Type the following command</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref9.png" alt="Alt text for image" width="586" height="60">
<br>
<li>Switch back to the browser window to check the status of the OpenVAS service</li>
<li>Click the + sign to start a new tab in the browser.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref10.png" alt="Alt text for image" width="1152" height="201">
<br>
<li>In the address bar, type https://localhost</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref11.png" alt="Alt text for image" width="570" height="77">
<br>
<li>On the opened page, click the Advanced… button.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref12.png" alt="Alt text for image" width="884" height="381">
<br>
<li>Click Accept the Risk and Continue.</li>
<br>
<li>A login page will appear once you click the button.<br>-Type <strong>admin</strong> as the username, <strong>admin</strong> as the password. 
<br>-Then, click the <strong>Login</strong> <strong>button</strong>. 
<br>-When prompted to save the password, click <strong>Don’t Save</strong>.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref13.png" alt="Alt text for image" width="488" height="169">
<br>
<li>The OpenVAS (Greenbone Security Assistant) Dashboard will popup.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref14.png" alt="Alt text for image" width="1141" height="628">
<br>
</ol>

# Scan the Vulnerability Using OpenVAS

## 2.1 Set the Target
<ol>
<li>In the OpenVAS dashboard window, click the Configuration, then Targets.</li>
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref15.png" alt="Alt text for image" width="1146" height="71">
<br>
<li>On the Targets page, click the upper-left star button to add a target.</li>
<br> 
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref16.png" alt="Alt text for image" width="531" height="162">
<br>
<li>In the New Target window.</li>
-TYPE metasploitable as the Name
<br>-ADD IP address 127.0.0.1 as the target address
<br>-change the Port List to All TCP
<br>-CLICK the Create button once finished.
<br>Since the docker is fowarding all ports to the local host we need to set the local host as the target.
<br> 
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref17.png" alt="Alt text for image" width="798" height="537">
<br>
<li>The target will be up after clicking the create button</li>
<br> 
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref18.png" alt="Alt text for image" width="1126" height="146">
<br>
</ol>

## Add a Task
<ol>
<li>Next, create a task to scan the target.</li>
-SELECT Scans > Tasks.
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref19.png" alt="Alt text for image" width="408" height="218">
<br>
<li>As of right now, there is no task.</li>
- CLICK the star button in the upper-left corner to add a new task.
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref20.png" alt="Alt text for image" width="324" height="213">
<br>
<li>In the New Task window:</li>
-TYPE the Name as metasploitable scan
<br>-SELECT the metasploitable as Scan Target
<br>-SELECT OpenVAS Default as the Scanner
<br>-SELECT Full and fast as the Scan Config. Click Create when finished.
<br>
<p align="center"><img src="https://github.com/ndean06/Vulnerability-Scans-OpenVAS/blob/main/images/vs-ovas-ref21.png" alt="Alt text for image" width="800" height="576">
<br>
</ol>

## 2.3 Scan Vulnerabilities and Check Reports
<ol>
<li>A newly created scan task appear in the Tasks window.</li>
To the lower right hand corner:
<br>-CLICK the Start button to start the scan. 
<br>The scan process may take 10 - 30 minutes.

</ol>





